<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Product Page</title>
  <link href="../dist/output.css" rel="stylesheet">
  <link rel="stylesheet" href="../font.awesome/css/font-awesome.min.css">
</head>

<body class="capitalize bg-gray-50">

  <!-- NAVBAR -->
  <nav class="bg-white flex flex-wrap items-center justify-between h-[80px] w-[90%] mx-auto px-4">
    <!-- Logo -->
    <div class="flex items-center space-x-2">
      <img class="h-10" src="../img/Brand/logo-symbol.svg" alt="">
      <span class="text-[28px] text-[#8CB7F5] font-extrabold">Brand</span>
    </div>
    <!-- Search bar (desktop only) -->
    <div class="hidden lg:flex items-center">
      <input id="search" class="w-64 lg:w-96 py-1 rounded-l-xl border-2 border-blue-600 pl-3" type="search"
        placeholder="Search">
      <button id="search-button" class="bg-blue-800 py-1.5 px-3 rounded-r-xl text-white">Search</button>
    </div>
    <!-- Menu icons (desktop only) -->
    <div class="hidden lg:flex text-[#8B96A5] text-[16px]" id="menu-icons">
      <ul class="flex space-x-4 md:space-x-7 items-center">
        <li class="flex flex-col items-center"><span class="fa fa-user"></span><span>Profile</span></li>
        <li class="flex flex-col items-center"><span class="fa fa-comment"></span><span>Message</span></li>
        <li class="flex flex-col items-center"><span class="fa fa-first-order"></span><span>Order</span></li>
        <li class="flex flex-col items-center"><span class="fa fa-cart-plus carts"></span><span>Carts</span></li>
      </ul>
    </div>
    <!-- Mobile menu button -->
    <button id="mobile-menu-button" class="lg:hidden text-blue-800 text-2xl">
      <i class="fa fa-bars"></i>
    </button>
  </nav>

  <!-- Mobile Menu -->
  <div id="mobile-menu" class="hidden lg:hidden bg-white w-[90%] mx-auto px-4 py-2 shadow-md">
    <ul class="flex flex-col space-y-3 text-[#8B96A5] text-[16px]">
      <li class="flex items-center space-x-2"><span class="fa fa-user"></span><span>Profile</span></li>
      <li class="flex items-center space-x-2"><span class="fa fa-comment"></span><span>Message</span></li>
      <li class="flex items-center space-x-2"><span class="fa fa-first-order"></span><span>Order</span></li>
      <li class="flex items-center space-x-2"><span class="fa fa-cart-plus carts"></span><span>Carts</span></li>
    </ul>
  </div>

  <!-- HEADER MENU -->
  <header
    class="flex flex-wrap items-center justify-between w-[90%] mx-auto mt-2 px-4 py-2 bg-white shadow-sm rounded-xl">
    <ul class="flex flex-wrap items-center space-x-4 text-[15px] text-gray-600">
      <li><i class="fa fa-bars text-blue-700"></i></li>
      <li class="hidden sm:inline">All Categories</li>
      <li class="hidden sm:inline">Hot Offers</li>
      <li class="hidden md:inline">Gift Boxes</li>
      <li class="hidden md:inline">Project</li>
      <li class="hidden lg:inline">Menu Item</li>
      <li class="hidden sm:inline">Help <i class="fa fa-angle-down"></i></li>
    </ul>
    <ul class="flex items-center space-x-6 text-[15px] text-gray-600">
      <li class="hidden sm:inline">English, USD</li>
      <li>Ship to <i class="fa fa-angle-down"></i></li>
    </ul>
    <button id="header-menu-btn" class="sm:hidden text-blue-700 text-xl">
      <i class="fa fa-ellipsis-v"></i>
    </button>
    <div id="header-mobile-menu"
      class="hidden flex flex-col items-start bg-white w-[90%] mx-auto mt-2 p-4 rounded-xl shadow-md text-gray-700">
      <ul class="space-y-2 text-[15px]">
        <li>All Categories</li>
        <li>Hot Offers</li>
        <li>Gift Boxes</li>
        <li>Project</li>
        <li>Menu Item</li>
        <li>Help</li>
        <li>English, USD</li>
        <li>Ship to</li>
      </ul>
    </div>
  </header>

  <!-- BREADCRUMBS -->
  <section class="w-[85%] md:w-[90%] mx-auto mt-4">
    <ul class="flex flex-wrap gap-2 text-sm text-gray-600">
      <li class="flex items-center">home <span class="fa fa-angle-right mx-1"></span></li>
      <li class="flex items-center">clothes <span class="fa fa-angle-right mx-1"></span></li>
      <li class="flex items-center">mens wear <span class="fa fa-angle-right mx-1"></span></li>
      <li class="flex items-center">summer clothes</li>
    </ul>
  </section>

  <!-- MAIN SECTION -->
  <section class="w-[85%] md:w-[90%] mx-auto mt-4 flex flex-col lg:flex-row gap-6">
    <!-- SIDEBAR -->
    <div class="w-full lg:w-[25%] bg-slate-100 p-4 rounded space-y-4">
      <h1 class="font-semibold text-lg">Category</h1>
      <ul class="space-y-1 text-gray-500">
        <li>Mobile Accessory</li>
        <li>Electronic</li>
        <li>Smartphone</li>
        <li>Modern Tech</li>
      </ul>
      <button class="text-gray-500">see all <span class="fa fa-angle-down"></span></button>
      <hr>

      <div class="text-[20px]">
        <h1 class="font-semibold">Brand</h1>
        <div class="catagory"></div>
        <button>see all <span class="fa fa-angle-down"></span></button>
      </div>
      <hr>

      <div class="text-[22px]">
        <h1 class="font-semibold">Feature</h1>
        <div class="space-y-1">
          <label><input type="checkbox"> <span class="ml-2">Metallic <br></span></label>
          <label><input type="checkbox"> <span class="ml-2">Plastic Cover <br></span></label>
          <label><input type="checkbox"> <span class="ml-2">8 GB RAM <br></span></label>
          <label><input type="checkbox"> <span class="ml-2">Super Power <br></span></label>
          <label><input type="checkbox"> <span class="ml-2">Large Memory</span></label>
        </div>
        <button class="mt-1">see all <span class="fa fa-angle-down"></span></button>
      </div>
      <hr>

      <div class="wrapper">
        <h2 class="font-semibold mb-2">Price Range</h2>
        <div class="price-input flex flex-col sm:flex-row gap-2 mb-2">
          <div class="field"><span>Min</span><input type="number"
              class="input-min border rounded px-1 w-full sm:w-[80px]" value="25"></div>
          <div class="separator">-</div>
          <div class="field"><span>Max</span><input type="number"
              class="input-max border rounded px-1 w-full sm:w-[80px]" value="50"></div>
        </div>
        <div class="slider w-full h-2 bg-gray-300 relative rounded">
          <div class="progress absolute h-full bg-blue-500 rounded"></div>
        </div>
        <div class="range-input flex gap-2 mt-2">
          <input type="range" class="range-min w-full" min="0" max="10000" value="2500" step="100">
          <input type="range" class="range-max w-full" min="0" max="10000" value="7500" step="100">
        </div>
      </div>
      <hr>

      <div class="text-[20px]">
        <h1 class="font-semibold">Condition</h1>
        <div class="space-y-1">
          <label><input type="checkbox"> <span class="ml-2">Any</span></label>
          <label><input type="checkbox"> <span class="ml-2">Refurbished</span></label>
          <label><input type="checkbox"> <span class="ml-2">Brand New</span></label>
          <label><input type="checkbox"> <span class="ml-2">Old Item</span></label>
        </div>
      </div>
      <hr>

      <div class="text-[20px]">
        <h1 class="font-semibold mb-2">Rating</h1>
        <div class="space-y-1">
          <ul class="flex items-center"><input type="checkbox">
            <li class="fa fa-star ml-2"></li>
            <li class="fa fa-star"></li>
            <li class="fa fa-star"></li>
            <li class="fa fa-star"></li>
            <li class="fa fa-star"></li>
          </ul>
          <ul class="flex items-center"><input type="checkbox">
            <li class="fa fa-star ml-2"></li>
            <li class="fa fa-star"></li>
            <li class="fa fa-star"></li>
            <li class="fa fa-star"></li>
            <li class="fa fa-star-o"></li>
          </ul>
          <ul class="flex items-center"><input type="checkbox">
            <li class="fa fa-star ml-2"></li>
            <li class="fa fa-star"></li>
            <li class="fa fa-star"></li>
            <li class="fa fa-star-o"></li>
            <li class="fa fa-star-o"></li>
          </ul>
          <ul class="flex items-center"><input type="checkbox">
            <li class="fa fa-star ml-2"></li>
            <li class="fa fa-star"></li>
            <li class="fa fa-star-o"></li>
            <li class="fa fa-star-o"></li>
            <li class="fa fa-star-o"></li>
          </ul>
        </div>
      </div>
    </div>

    <!-- PRODUCTS -->
    <div class="w-full lg:w-[75%] product10 grid grid-cols-1 gap-4">
      <!-- JS will append products here -->
    </div>
  </section>

  <!-- NEWSLETTER -->
  <section class="w-11/12 max-w-6xl mx-auto mt-6 bg-gray-200 rounded p-6 text-center">
    <h3 class="text-lg font-bold">Subscribe to our newsletter</h3>
    <p class="mt-2">Get daily news on upcoming offers from many suppliers all over the world</p>
    <div class="mt-4 flex flex-col sm:flex-row justify-center gap-2">
      <input type="email" placeholder="Email" class="p-2 rounded border w-full sm:w-1/2" />
      <button class="bg-blue-700 text-white px-4 py-2 rounded">Subscribe</button>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="w-11/12 max-w-6xl mx-auto mt-10 grid grid-cols-1 md:grid-cols-6 gap-6 pb-12">
    <div class="md:col-span-2">
      <div class="flex items-center gap-3">
        <img class="h-8" src="../img/Brand/logo-symbol.svg" alt="logo" />
        <span class="text-xl font-extrabold text-[#127FFF]">Brand</span>
      </div>
      <p class="mt-4 text-sm">Best information about company. Lorem ipsum dolor sit amet.</p>
      <ul class="flex gap-3 mt-4 text-sm">
        <li><a href="#" class="fa fa-facebook-f"></a></li>
        <li><a href="#" class="fa fa-twitter"></a></li>
        <li><a href="#" class="fa fa-linkedin"></a></li>
        <li><a href="#" class="fa fa-instagram"></a></li>
      </ul>
    </div>
    <div class="text-sm">
      <h4 class="font-bold mb-2">About</h4>
      <p>About Us<br />Find store<br />Categories<br />Blogs</p>
    </div>
    <div class="text-sm">
      <h4 class="font-bold mb-2">Partnership</h4>
      <p>About Us<br />Find store<br />Categories<br />Blogs</p>
    </div>
    <div class="text-sm">
      <h4 class="font-bold mb-2">Information</h4>
      <p>Help center<br />Money refund<br />Shipping<br />Contact us</p>
    </div>
    <div class="text-sm">
      <h4 class="font-bold mb-2">For user</h4>
      <p>Login<br />Register<br />Setting<br />Orders</p>
    </div>
  </footer>
  <!-- JS -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const productsDiv = document.querySelector(".product10");
      const categoryDiv = document.querySelector(".catagory");
      const minInput = document.querySelector(".input-min");
      const maxInput = document.querySelector(".input-max");
      const rangeMin = document.querySelector(".range-min");
      const rangeMax = document.querySelector(".range-max");
      const searchInput = document.querySelector(".search-bar");

      let allProducts = [];
      let categories = [];

      // ----------------------------
      // Fetch products from API
      // ----------------------------
      async function fetchProducts() {
        try {
          const response = await fetch("https://fakestoreapi.com/products");
          allProducts = await response.json();

          // Save allProducts in localStorage
          localStorage.setItem("allProducts", JSON.stringify(allProducts));

          // Price range
          const prices = allProducts.map(p => p.price);
          minInput.value = Math.floor(Math.min(...prices));
          maxInput.value = Math.ceil(Math.max(...prices));
          rangeMin.value = minInput.value;
          rangeMax.value = maxInput.value;

          // Categories
          allProducts.forEach(product => {
            if (!categories.includes(product.category)) {
              categories.push(product.category);
              const label = document.createElement("label");
              label.className = "flex items-center font-medium mb-1";

              const checkbox = document.createElement("input");
              checkbox.type = "checkbox";
              checkbox.value = product.category;
              checkbox.addEventListener("change", applyFilters);

              const span = document.createElement("span");
              span.className = "ml-2";
              span.textContent = product.category;

              label.appendChild(checkbox);
              label.appendChild(span);
              categoryDiv.appendChild(label);
            }
          });

          applyFilters();
        } catch (error) {
          console.error("Failed to fetch products:", error);
          productsDiv.innerHTML = `<h2 class="text-center text-red-500 font-bold">Failed to load products!</h2>`;
        }
      }

      // ----------------------------
      // Create HTML for a product
      // ----------------------------
      function createProductHTML(product) {
        return `
      <div class="product-card h-auto w-full flex bg-white border-2 p-3 cursor-pointer" data-id="${product.id}">
        <div class="w-[17%]">
          <img src="${product.image}" alt="${product.title}" class="h-[120px] w-[120px] object-contain">
        </div>
        <div class="w-[70%] ml-4">
          <h1 class="font-semibold">${product.title}</h1>
          <h1 class="font-bold mt-2">$${product.price.toFixed(2)}</h1>
          <p class="mt-1 text-gray-600">${product.description.slice(0, 120)}...</p>
          <button class="add-cart-btn bg-blue-600 text-white px-3 py-1 rounded mt-2" data-id="${product.id}">Add to Cart</button>
        </div>
      </div>
    `;
      }

      // ----------------------------
      // Display filtered products
      // ----------------------------
      function displayProducts(filteredProducts) {
        productsDiv.innerHTML = "";
        if (filteredProducts.length === 0) {
          productsDiv.innerHTML = `<h2 class="text-center text-red-500 font-bold">No products found!</h2>`;
          return;
        }
        filteredProducts.slice(0, 6).forEach(product => {
          const html = createProductHTML(product);
          productsDiv.insertAdjacentHTML("beforeend", html);
        });
      }

      // ----------------------------
      // Apply filters
      // ----------------------------
      function applyFilters() {
        let filtered = [...allProducts];

        // Category filter
        const checkedCategories = Array.from(categoryDiv.querySelectorAll("input[type=checkbox]:checked"))
          .map(cb => cb.value);
        if (checkedCategories.length > 0) {
          filtered = filtered.filter(p => checkedCategories.includes(p.category));
        }

        // Price filter
        const minPrice = parseFloat(minInput.value);
        const maxPrice = parseFloat(maxInput.value);
        if (!isNaN(minPrice) && !isNaN(maxPrice)) {
          filtered = filtered.filter(p => p.price >= minPrice && p.price <= maxPrice);
        }

        // Search filter
        const searchText = searchInput ? searchInput.value.toLowerCase() : "";
        if (searchText.trim() !== "") {
          filtered = filtered.filter(p =>
            p.title.toLowerCase().includes(searchText) ||
            p.category.toLowerCase().includes(searchText)
          );
        }

        displayProducts(filtered);
      }

      // ----------------------------
      // Product click + add to cart
      // ----------------------------
      productsDiv.addEventListener("click", e => {
        const productCard = e.target.closest(".product-card");
        if (!productCard) return;

        const productId = productCard.dataset.id;
        const product = allProducts.find(p => String(p.id) === String(productId));
        if (!product) return;

        // Add to cart
        if (e.target.classList.contains("add-cart-btn")) {
          e.stopPropagation();

          // Safe login check
          let user = null;
          try {
            user = JSON.parse(localStorage.getItem("user"));
          } catch {
            user = null;
          }

          if (!user || !user.email) {
            alert("Please login first!");
            window.location.href = "./form.html";
            return;
          }

          // Add product to user's cart
          const cartKey = `cart_${user.email}`;
          let cart = JSON.parse(localStorage.getItem(cartKey)) || [];
          const existing = cart.find(item => item.id === product.id);
          if (existing) existing.qty += 1;
          else cart.push({ ...product, qty: 1 });

          localStorage.setItem(cartKey, JSON.stringify(cart));
          window.location.href = "./cart.html";
        }
        // Click product â†’ go to product detail
        else {
          localStorage.setItem("selectedProductId", product.id);
          window.location.href = "./productdetail.html";
        }
      });

      // ----------------------------
      // Price range sync
      // ----------------------------
      rangeMin.addEventListener("input", e => { minInput.value = e.target.value; applyFilters(); });
      rangeMax.addEventListener("input", e => { maxInput.value = e.target.value; applyFilters(); });
      minInput.addEventListener("input", applyFilters);
      maxInput.addEventListener("input", applyFilters);
      if (searchInput) searchInput.addEventListener("input", applyFilters);

      // ----------------------------
      // Initialize
      // ----------------------------
      fetchProducts();
    });

    // ----------------------------
    // Mobile Menu Toggle
    // ----------------------------
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const mobileMenu = document.getElementById('mobile-menu');
    mobileMenuButton?.addEventListener('click', () => mobileMenu?.classList.toggle('hidden'));

    const headerMenuBtn = document.getElementById('header-menu-btn');
    const headerMobileMenu = document.getElementById('header-mobile-menu');
    headerMenuBtn?.addEventListener('click', () => headerMobileMenu?.classList.toggle('hidden'));
  </script>












</body>

</html>